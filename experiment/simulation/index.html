<!-- This HTML page and script files are developed by
    Piyali Chattopadhyay
    Project Scientist-Technical,
    Virtual Labs IIT Kharagpur.-->

<!DOCTYPE html>
<html lang="en"><!--html tag start-->
<head>
    <title>Study and operation of the DC Speed and Position control setup</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/adik.css" rel="stylesheet">
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script  src="./js/DC_SP.js">   </script>
  
  
	
 <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.js"></script>
  <script src=" https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.min.js  "></script>
 
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"> </script>
 

<link rel="stylesheet" href="./css/DC_SP.css">
<link rel="stylesheet" href="./css/demo.css">



  <style>
	<!-- .bluedot{
	position:absolute;
    border: 2px solid #0C0C0C;
    border-radius:50%;
    background-color:#0C0C0C;
    background-image:linear-gradient(90deg,#0C0C0C,#00ccff);
	box-shadow: 5px 5px 8px #888888;
	}
	.handlep{
	position:absolute;
    border: 2px solid blue;
    border-radius:50%;
    background-color:white;
    background-image:url(./images/plus.png);
	background-size:cover;
	background-position:center;
	
	}
	
	.handlen{
	position:absolute;
    border: 2px solid blue;
    border-radius:50%;
    background-color:white;
    background-image:url(./images/minus.jpg);
	background-size:cover;
	background-position:center;
	
	} -->
	
	.dial {
	
position:absolute;
    border: 2px solid #060808;
    border-radius:50%;
    background-color:#060808;
    background-image:linear-gradient(90deg,#060808,#3A3B3B);
	
	box-shadow: 5px 5px 8px #D9DBDB;
}

.dialhandle {
	
position:absolute;
cursor:pointer;
background-color: #11B8C9;
  animation: glow 1s ease-in-out infinite alternate;
}
@-webkit-keyframes glow {
  from {
    text-shadow:  0 0 20px #fff, 0 0 30px #0867DF;
  }
  
  to {
    text-shadow: 0 0 20px #fff, 0 0 30px #023474;
  }
}

	
	
	
  </style>
  
  
  
</head>
<body><!--body tag start-->
    <div class="container p-3 my-3 text-primary text-center border"><!--First Container under body tag start-->
        <div class="row"><!--First row under 1st container start-->
            <div class="col-md-3"><!--First col under 1st row start-->
                <img class="img-fluid rounded" src="./images/vlabs.png" alt="VLabs logo">
            </div><!--First col under 1st row end-->
            <div class="col-md-6"><!--2nd col under 1st row start-->
                <p class="display-1"> <b> Virtual Labs <br> IIT Kharagpur </b> </p>
            </div><!--2nd col under 1st row end-->
            <div class="col-md-3"><!--3rd col under 1st row start-->
                <img class="img-fluid rounded" src="./images/iitkgp.png" alt="IIT KGP Logo" >
            </div><!--3rd col under 1st row end-->
        </div><!--First row under 1st container end-->
    
        <hr>
        <div class="row"><!--2nd row under 1st container start-->
            <div class="col-md-3"><!--First col under 2nd row start-->

            </div><!--First col under 2nd row end-->
            <div class="col-md-6"><!--2nd col under 2nd row start-->
                <p class="h1"> <b>Simulation</b> </p>
            </div><!--2nd col under 2nd row end-->
            <div class="col-md-3"><!--3rd col under 2nd row start-->

            </div><!--3rd col under 2nd row end-->
        </div><!--2nd row under 1st container end-->
        <hr>
        
    </div><!--First Container under body tag end-->
    
	
    <div class="container p-3 my-5 text-left border"><!--3rd Container under body tag start-->
      <div class="row"><!--First row under 3rd container start-->
        <div class="col-md-1"></div><!--First col under 3rd container start& end-->
        <div class="col-md-10"><!--2nd col under 3rd container start-->
            <p class="text-center bg-success"> <a class="nav-link" data-bs-toggle="tab"  id="instcontrol" style="background-color:#128BD9"  ><span class=" h3 text-dark"> Instructions </span></a>
              <div id="inst" style="display:block;height:200px;overflow-y:auto;text-align:justify">
					<ol>
					<b>Find Tacho Generator Constant</b><br/>
					
                      <li>First connect the circuit diagram properly through the connecting dots (black dots) according to the instructions below.<br/><br/>
					  
					  Attenuator Unit upper potentiometer point 1 - Power Supply 0 V (left one), Attenuator Unit upper potentiometer point 3 - Power Supply +15 V (left one),
					  Attenuator Unit upper potentiometer point 2 - Servo Amplifier point 1, Servo Amplifier point (3-6, 4-5, 7-8).</li></br>
  
					  <li>Click on 'Check Connection' button to check whether the connection is proper or not. Click on the 'Power' switch in Power Supply box, the led will glow.</li><br/>
					 
					 <li>Rotate the upper potentiometer knob in Attenuator Unit. Observe the tacho generator voltage in the black box above dc motor tacho unit
					 plate. Rotate the knob untill the tacho generator voltage is about 1 V and motor starts rotating, observe the speed of the motor.</li><br/>

					 <li>Now click on 'Show Table' button to get the observation data. Check output around 2, 3, 4 and 5 volts of tacho generator following steps 3-4 and click on 'Show Table' button
					 each time after increasing the voltage.</li><br/>
					 
					<li>Click on 'Plot' button to observe the plot 'Motor Speed (rpm) Vs. Tacho generator voltage (Volts)' and calculate the tacho generator constant (<span style="font-family:'Bodoni MT'"><i>k</i><sub>g</sub></span>)
					from the slope in 'Motor Speed (rpm) Vs. Tacho generator voltage (Volts)' plot (explained in procedure section). Enter the value of <span style="font-family:'Bodoni MT'"><i>k</i><sub>g</sub></span> in corresponding box beside observation table.
					Click on 'Download Plot' button to download the plot.
					</li><br/> 
					 
					<li> Rotate the potentiometer knobs to its minimum value to stop the motor, switch off the power. Click on 'Clear' button</li><br/> 
					 </ol>
					<br><br>
					
					<ol> 
					<b>Speed Control (Open Loop and Closed Loop)</b><br/>
					
                      <li>First connect the circuit diagram properly through the connecting dots (black dots) according to the instructions below.<br/><br/>
					  
					  Attenuator Unit lower potentiometer point 4 - Op Amp Unit 0 V, Attenuator Unit lower potentiometer point 5 - Op Amp Unit point 2,					  
					  Attenuator Unit lower potentiometer point 6 - Op Amp Unit -15 V, Op Amp Unit point 6 (upper one) - Servo Amplifier point 1,
					  Servo Amplifier point (3-6, 4-5, 7-8), Op Amp Unit +15 V - Power Supply +15 V (left one), Op Amp Unit -15 V - Power Supply -15 V (left one),
					  Op Amp Unit 0 V - Power Supply 0 V (left one), DC motor tacho unit lower point - Power Supply 0 V, DC motor tacho unit lower point - DC motor tacho unit point 2 (first one).
					  
					  </li></br>
  
					  <li>Click on 'Check Connection' button to check whether the connection is proper or not. Click on the 'Power' switch in Power Supply box ,the led will glow.</li><br/>
					 
					 <li>Rotate the lower potentiometer knob in Attenuator Unit. Observe the reference voltage, error voltage and Speed. 
					 Rotate the knob untill the motor starts rotating at around 2000 rpm. Observe the tacho generator voltage in the black box above dc motor tacho unit plate.
					 Click on 'Show Table' button to get the observation data.</li><br/>
					 
					 
					<li>Now click on the plus sign on 'Brake Change' to set the magnetic braking (loading) arrangement to point 2. Observe the change in speed and tacho generator voltage.</li><br/> 
					 

					 <li>Now click on 'Show Table' button to observe the observation table. Change brake position from 2-10 in step of 2 and check speed, tacho generator voltage 
						following step 4 and click on 'Show Table' button each time after changing brake position.</li><br/>
					 
					<li>Now click on 'Plot' button to observe the plot 'Motor Speed (rpm) Vs. Braking Load (units)'. Click on 'Download Plot' button to download the plot.</li><br/>

					<li> Rotate the potentiometer knobs to its minimum value to stop the motor, switch off the power. Click on 'Clear' button.</li><br/>

					<li> Now make the circuit connection following step 1 and connect the velocity error feedback (Op Amp Unit point 3 - DC motor tacho unit point 1 (first one)) for closed loop control
					and follow steps 2-6 again.</li><br/>
					
					 <li> Click on 'Pre amplifier Characteristics' button to observe the characteristics of the pre amplifier , click on 'Position Control' button to perform the experiment of 
					 controlling the position of the motor rotor. To perform the experiment of controlling the speed of the motor click on 'Speed Control' button.</li><br/>
					</ol>
					<br><br>
					 
		   </div>
            </p> 
          </div><!--2nd col under 3rd container end-->
		  
        <div class="col-md-1"></div><!--3rd col under 3rd container start& end-->
      </div><!--First row under 3rd container end-->
    </div><!--3rd Container under body tag end-->
	
    <div class="container p-3 my-5 text-center border" id="canvas" ><!--Fourth container under body tag start-->
	
<div class="row ">
	<div class="col-md-1"></div>
	
	
		<div class="col-md-5" >
		<div class="img-container">		
		<img class="img-fluid " id="servo" src="images/servo_amp.png " />
		<div id="bd17"></div>
		<div id="bd18"></div>
		<div id="bd19"></div>
		<div id="bd20"></div>
		<div id="bd21"></div>
		<div id="bd22"></div>
		<div id="bd23"></div>
		<div id="bd24"></div>
		<div id="bd25"></div> 
		<div id="bd26"></div>
		<div id="bd27"></div>
		<div id="bd28"></div>
		</div>
		<button type="button" id="tacho_olclSpeed"  class="btn btn-primary" onclick="part1_2_3()" >Speed Control</button>
		<button type="button" id="preAmp_Char"  class="btn btn-primary" onclick="part4_5()" >Pre amplifier Characteristics</button>
		<button type="button" id="PositionC"  class="btn btn-primary " onclick="part6_7()" >Position Control</button>		
		</div>
		
		
		<div class="col-md-5" >
		<div class="img-container">
		<img class="img-fluid " id="power" src="images/power_supply.png " />
		<img class="img-fluid " id="ammeter" src="images/amp_pointer.jpg " />
		<img class="img-fluid " id="powerled" src="images/groff.png " />
		<img class="img-fluid " id="togsw" src="images/off.png " onclick="power_on()" />
		<div id="bd29"></div>
		<div id="bd30"></div>
		<div id="bd31"></div>
		<div id="bd32"></div>
		<div id="bd33"></div>
		<div id="bd34"></div>
		<div id="bd35"></div> 
		<div id="bd36"></div>
		<div id="bd37"></div>
		</div>
		<button type="button" id="check"  class="btn btn-primary " >Check Connection</button>
		<button type="button" id="drawTable"  class="btn btn-info " onclick="createTable()" >Show Table</button>
		<button type="button" id="drawPlot"  class="btn btn-success " onclick="plot()" >Plot</button>
		<button type="button" id="clear"  class="btn btn-danger " onclick="refresh()" >Clear</button>
		
		<input type="number" id="partchk" min="1" value="1" max="7" style="visibility:hidden;"><!--checks exp parts-->
		</div>		
		
		<div class="col-md-1"></div>
		</div>
		
		
		
		<div class="row"><!----------invisible gap for placing Tacho unit of dc motor-------------->
		<div class="col-md-1"></div>
		<div class="col-md-10" >
		<div class="img-container">
		<img class="img-fluid " id="motorinv" src="images/motor.png " style="visibility:hidden" />
		<input type="number" id="tachoV"  value="0" readOnly=readOnly><span style="color:blue;font-weight:bold;position:absolute;top:27%;left:49%">Tacho generator voltage (V)</span>
		<input type="number" id="tachospeed"  value="0" readOnly=readOnly><span style="color:blue;font-weight:bold;position:absolute;top:104%;left:97%">rpm</span>
		</div>					
		</div>
		<div class="col-md-1"></div>		
		</div>
		
		<div class="row my-5 gy-2">
		<div class="col-md-1"></div>
		<div class="col-md-10" >
		<div class="img-container">
		
		
		<img class="img-fluid " id="magnet_holder" src="images/MLOAD_FIXED.png " />
		<img class="img-fluid " id="magnet_brake" src="images/MLOAD_var.png " />
		<img class="img-fluid " id="motor" src="images/motor.png "style="z-index:1" />
		<img class="img-fluid " id="motor_plate" src="images/DC-TACHO.png " />
		<img class="img-fluid " id="rotor" src="images/rotor.png " />
		
		<input type="number" id="brakeposi" min="0" value="0" max="10" step="1" readOnly=readOnly style="text-align: center;color: red;font-weight: bold;position: absolute;top: 97%;left: 85%;">
		<span style="color:blue;font-weight:bold;position:absolute;top:95%;left:71%">Brake Position</span>
				
		<button type="button" id="brake_change"  class="btn btn-warning " disabled=disable>
		 <i class="fa fa-plus"  onclick="BrakeChange();speedBrake();Wheel_SpeedDown()" style="color:red"></i>Brake Change<i class="fa fa-minus"  onclick="BrakeChangerev();speedBrake();Wheel_SpeedUp()" style="color:red"></i>
		</button>
		
		
		<div id="bd38"></div> 
		<div id="bd39"></div>
		<div id="bd40"></div>
		<div id="bd41"></div>
		<div id="bd42"></div>
		<div id="bd43"></div>
		</div>	
				
		</div>
		<div class="col-md-1"></div>		
		</div>
	
	
		<div class="row my-5 gy-2">
		<div class="col-md-1"></div>
		<div class="col-md-5" >
		<div class="img-container">
		
		<input type="number" id="refV" min="-14.5" max="0" step="1.45" value="0" readOnly=readOnly><span style="color:blue;font-weight:bold;position:absolute;top:-12%;left:11%">Reference voltage (V)</span>
		<input type="number" id="errV"  value="0" readOnly=readOnly><span style="color:blue;font-weight:bold;position:absolute;top:-12%;left:56%">Error Voltage (V)</span>
		
		<img class="img-fluid " id="AU" src="images/AU.png " />
		<!---knob 1 1st col 1st row--------->
		<!-- <div class="bluedot" id="knob1" style=" width:21.5%;height:18.5%;top:13%;left:18.5%;pointer-events:none;">
		<div class="handlep" id="knob1p" onclick="rotate1();Wheel_SpeedUp()"style="width:30%;height:30%;top:33%;left:0%;"></div>
		<div class="handlen" id="knob1n"onclick="rotate2();Wheel_SpeedDown()" style="width:30%;height:30%;top:33%;left:70%;"></div>
		</div> -->
		<div id="knob1" class="dial"  style=" width:21.5%;height:18.5%;top:13%;left:18.5%;pointer-events:none;">
		<div class="dialhandle" style="width:20%;height:5%;top:85%;left:20%;transform:rotate(304deg)"></div>				
		</div>
		<input type="number" id="Au_up" min="0" value="0" max="10" step="0.1" style="position: absolute;width: 18%;height: 6%;top: 30%;left: 22%;text-align: center;background: transparent;border: none;"readOnly=readOnly>
		
		<!---knob 2 1st col 1st row--------->
		<!-- <div class="bluedot" id="knob2" style=" width:22.4%;height:19%;top:51.5%;left:20.7%;pointer-events:none;">
		<div class="handlep" id="knob2p" onclick="rotate3();Wheel_SpeedUp()"style="width:30%;height:30%;top:33%;left:0%;"></div>
		<div class="handlen" id="knob2n"onclick="rotate4();Wheel_SpeedDown()" style="width:30%;height:30%;top:33%;left:70%;"></div>
		</div> -->
		<div id="knob2" class="dial"  style="width:22.4%;height:19%;top:51.5%;left:20.7%;pointer-events:none;">
		<div class="dialhandle" style="width:20%;height:5%;top:85%;left:20%;transform:rotate(304deg)"></div>				
		</div>
		<input type="number" id="Au_down" min="0" value="0" max="10" step="1" style="position: absolute;width: 23%;height: 6%;top: 69%;left: 22%;text-align: center;background: transparent;border: none;"readOnly=readOnly>
		
		<!--Connection points in this circuit only-->
		<div id="bd1"></div> 
		<div id="bd2"></div>
		<div id="bd3"></div>
		<div id="bd4"></div>
		<div id="bd5"></div>
		<div id="bd6"></div> 
		
		
		
		
		</div>	
		<input type="number" id="Au_upchk" min="0" value="0" max="60" step="1" style="visibility:hidden"readOnly=readOnly>
		</div>
		
		<div class="col-md-5" >
		<div class="img-container" id="col6">	
		<img class="img-fluid " id="OU" src="images/OpAmpUnit.png " />
		<img class="img-fluid " id="feedbk_select" src="images/FEEDBACK_SELECTOR.png " />
		
		<div id="bd7"></div>
		<div id="bd8"></div>
		<div id="bd9"></div>
		<div id="bd10"></div>
		<div id="bd11"></div>
		<div id="bd12"></div>
		<div id="bd13"></div>
		<div id="bd14"></div>
		<div id="bd15"></div> 
		<div id="bd16"></div>
		
		</div>						
		</div>		
		
		<div class="col-md-1"></div>		
		</div>

	
   
			<div class="row my-5 gy-2"><!--- 4th row under fourth container start--->
	
		 
        <div class="col-md-8 "><!--1st col under 4th row start -->	
		
		
			<table id="myTable1" style="visibility:hidden;width:100%">
			
				
				  <tr>
					<th>Sl No.</th>
					<th>Tacho generator voltage (V<sub>g</sub>)( Volts )</th> 
					<th>Speed (N)(rpm)</th>
				  </tr>
				  
			</table>
			<table id="myTable2" style="visibility:hidden;width:100%">
			
				
				  <tr>
					<th>Sl No.</th>
					<th>Brake Position</th>
					<th>Reference Voltage (Volts)</th>
					<th>Error Voltage (Volts)</th>					
					<th>Tacho generator voltage (<span style="font-family:'Times New Roman'">V<sub>g</sub></span>)(Volts)</th> 
					<th>Speed (N)(rpm)</th>
				  </tr>
				  
			</table>
			
		</div>
		<div class="col-md-4 "><!--1st col under 4th row start -->	
		
		<span id="part1_result" style="display:none;"><i style="font-family:'Bodoni MT'">k</i><sub style="font-family:'Bodoni MT'">g</sub>&nbsp;(Tachogenerator Constant)&nbsp;<br/><br/><input type="number" id="kgc" value="0" style="text-align:center"> Volts/rpm</span>
			
		</div>
			
		</div>


	 <div class="row justify-content-center"><!-----------------------graph T vs. w----------------------------------------->
		
	 
			<div class="col-md-12">
				<div id = "plotbucket" class="content-center" style="display:none; position:relative; border:3px solid white;height:530px;width:823px ">
				<button type="button" id="exportChart" class="btn btn-primary"  style="display:none;position:absolute;left:9%;">Download Plot</button>
				<button type="button" id="result" class="btn btn-primary" onclick="refresh()"  style="display:none;position:absolute;left:27%">OK</button><br/><br/>
					<div id="chartContainer"  style="display:none; position:absolute; height: 80%; width: 100%;z-index:1 "></div>
					
					
				</div>
				
			</div>
			
			
		
	</div>	

	
	
          <!-- Code End here-->
        </div><!--Fourth container under body tag end-->
          
      <!--</div>
    </div>-->

    <div class="container p-3 my-5 text-primary text-center border"><!--Last and fifth container under body tag start-->
      <div class="row">
        <footer>
          <div class="row ce">
            <div class="col-sm-12">
              <p class="h5"><i> Copyright ©2022 <a href="http://vlabs.iitkgp.ac.in/vlt/">Virtual Labs IIT Kharagpur</a> </i><br><br>
              <a href="../../license/index.html" target="_blank"> Licensing Terms </a>
            </p>
            </div>
          </div>
        </footer>
      </div>
  </div><!--Last and fifth container under body tag end-->
  <script>

var knobPositionX;
      var knobPositionY;
      var mouseX;
      var mouseY;
      var knobCenterX;
      var knobCenterY;
      var adjacentSide;
      var oppositeSide;
      var currentRadiansAngle;
      var getRadiansInDegrees;
      var finalAngleInDegrees;
      var volumeSetting;
      //var tickHighlightPosition;
      //var audio = new Audio("https://www.cineblueone.com/maskWall/audio/skylar.mp3"); //Celine Dion's "Ashes"
      //var startingTickAngle = -135;
      //var tickContainer = document.getElementById("tickContainer");
      var knob1 = document.getElementById("knob1");
	  var knob2 = document.getElementById("knob2");
	  
      var boundingRectangle1 = knob1.getBoundingClientRect(); //get rectangular geometric data of knob (x, y, width, height)
	  var boundingRectangle2 = knob2.getBoundingClientRect();
	 
      function main1()
      {
          knob1.addEventListener(getMouseDown(), onMouseDown1); //listen for mouse button click
          document.addEventListener(getMouseUp(), onMouseUp1); //listen for mouse button release
	  }
	  function main2()
      {
          knob2.addEventListener(getMouseDown(), onMouseDown2); //listen for mouse button click
          document.addEventListener(getMouseUp(), onMouseUp2); //listen for mouse button release
	  }
	  
      //on mouse buttons down
      function onMouseDown1()
      {
	  document.addEventListener(getMouseMove(), onMouseMove1); //start drag
      }	  
	  function onMouseDown2()
      {
	  document.addEventListener(getMouseMove(), onMouseMove2); //start drag
      }
	  
      //on mouse buttons release
      function onMouseUp1()
      {
          document.removeEventListener(getMouseMove(), onMouseMove1); //stop drag
      }
	  function onMouseUp2()
      {
          document.removeEventListener(getMouseMove(), onMouseMove2); //stop drag
      }
	  
      //compute mouse angle relative to center of volume knob
      //For clarification, see my basic trig explanation at:
      //https://www.quora.com/What-is-the-significance-of-the-number-pi-to-the-universe/answer/Kevin-Lam-15
      function onMouseMove1(event)
      {	  
          knobPositionX = boundingRectangle1.left; //get knob's global x position
          knobPositionY = boundingRectangle1.top; //get knob's global y position

          if(detectMobile() == "desktop")
          {
              mouseX = event.pageX; //get mouse's x global position
              mouseY = event.pageY; //get mouse's y global position
          } else {
              mouseX = event.touches[0].pageX; //get finger's x global position
              mouseY = event.touches[0].pageY; //get finger's y global position
          }

          knobCenterX = boundingRectangle1.width / 2 + knobPositionX; //get global horizontal center position of knob relative to mouse position
          knobCenterY = boundingRectangle1.height / 2 + knobPositionY; //get global vertical center position of knob relative to mouse position

          adjacentSide = knobCenterX - mouseX; //compute adjacent value of imaginary right angle triangle
          oppositeSide = knobCenterY - mouseY; //compute opposite value of imaginary right angle triangle

          //arc-tangent function returns circular angle in radians
          //use atan2() instead of atan() because atan() returns only 180 degree max (PI radians) but atan2() returns four quadrant's 360 degree max (2PI radians)
          currentRadiansAngle = Math.atan2(adjacentSide, oppositeSide);

          getRadiansInDegrees = currentRadiansAngle * 180 / Math.PI; //convert radians into degrees

          finalAngleInDegrees = -(getRadiansInDegrees - 135); //knob is already starting at -135 degrees due to visual design so 135 degrees needs to be subtracted to compensate for the angle offset, negative value represents clockwise direction
		var finalAngleInDegrees2 = -(getRadiansInDegrees);///to design Attenuator Unit upper potentiometer knob. the knob value will be up to 10 but due to that the generated Tacho generator voltage should rise upto 15 V.
		
          //only allow rotate if greater than zero degrees or lesser than 270 degrees
          if(finalAngleInDegrees >= 0 && finalAngleInDegrees <= 300)
          {
              knob1.style.transform = "rotate(" + finalAngleInDegrees + "deg)"; //use dynamic CSS transform to rotate volume knob

              //270 degrees maximum freedom of rotation / 100% volume = 1% of volume difference per 2.7 degrees of rotation
              volumeSetting = Math.round(finalAngleInDegrees / (300 / 100));///to rotate upper potentiometer knob upto 10
			  var volumeSetting2 = Math.round(finalAngleInDegrees2 / (300 / 100));/// to get voltage of tacho generator
			  
              var voltValue = volumeSetting * (10/100); 
              document.getElementById("Au_up").value = math.floor(voltValue * 10)/10 ;//+ "%"; //update volume text
			  
			  if(document.getElementById('partchk').value == 1){
				var voltValue2 = volumeSetting2 * (90/100);
				document.getElementById('Au_upchk').value = math.round(voltValue2);
				Wheel_SpeedUp();
				}
				if(document.getElementById('Au_up').value < 4.5){///part chk 1 tacho gen const.
				document.getElementById('Au_upchk').value = 0;
				Wheel_SpeedDown();
				}
			  ///Triggerring Function
				if(document.getElementById('partchk').value == 1){	
				tacho_const();
				}
			  
          }
      }

///knob2/////
function onMouseMove2(event)
      {
          knobPositionX = boundingRectangle2.left; //get knob's global x position
          knobPositionY = boundingRectangle2.top; //get knob's global y position

          if(detectMobile() == "desktop")
          {
              mouseX = event.pageX; //get mouse's x global position
              mouseY = event.pageY; //get mouse's y global position
          } else {
              mouseX = event.touches[0].pageX; //get finger's x global position
              mouseY = event.touches[0].pageY; //get finger's y global position
          }

          knobCenterX = boundingRectangle2.width / 2 + knobPositionX; //get global horizontal center position of knob relative to mouse position
          knobCenterY = boundingRectangle2.height / 2 + knobPositionY; //get global vertical center position of knob relative to mouse position

          adjacentSide = knobCenterX - mouseX; //compute adjacent value of imaginary right angle triangle
          oppositeSide = knobCenterY - mouseY; //compute opposite value of imaginary right angle triangle

          //arc-tangent function returns circular angle in radians
          //use atan2() instead of atan() because atan() returns only 180 degree max (PI radians) but atan2() returns four quadrant's 360 degree max (2PI radians)
          currentRadiansAngle = Math.atan2(adjacentSide, oppositeSide);

          getRadiansInDegrees = currentRadiansAngle * 180 / Math.PI; //convert radians into degrees

          finalAngleInDegrees = -(getRadiansInDegrees - 135); //knob is already starting at -135 degrees due to visual design so 135 degrees needs to be subtracted to compensate for the angle offset, negative value represents clockwise direction
		 
          //only allow rotate if greater than zero degrees or lesser than 270 degrees
          if(finalAngleInDegrees >= 0 && finalAngleInDegrees <= 300)
          {
              knob2.style.transform = "rotate(" + finalAngleInDegrees + "deg)"; //use dynamic CSS transform to rotate volume knob

              //270 degrees maximum freedom of rotation / 100% volume = 1% of volume difference per 2.7 degrees of rotation
              volumeSetting = Math.floor(finalAngleInDegrees / (300 / 100));
			   
				var voltValue = volumeSetting * (10/100); 
				var rev = volumeSetting * (15/100); 
              document.getElementById("Au_down").value = math.round(voltValue);
			  
						  ///increase in Reference voltage with knob value for open loop speed control function,from lab test data in this case ref voltage increases in a step of 1.45 
				if(document.getElementById('partchk').value == 2 || document.getElementById('partchk').value == 3){
				document.getElementById('refV').value = -math.floor(rev*100)/100;
				}	
				else{
				document.getElementById('refV').value=0;
				}
				
				///Triggerring Function
				
				if(document.getElementById('partchk').value == 2){	
					OpenLoop_SpeedControl();
					Wheel_SpeedUp();
				}
				if(document.getElementById('partchk').value == 3){	
					ClosedLoop_SpeedControl();
					Wheel_SpeedUp();
				}
				if(document.getElementById('Au_down').value < 4.5 && (document.getElementById('partchk').value == 2 || document.getElementById('partchk').value == 3)){///part chk 1 tacho gen const.
				//document.getElementById('Au_downc').value = 0;
				Wheel_SpeedDown();
				}
              
             // document.getElementById("volumeValue").innerHTML = volumeSetting + "%"; //update volume text
          }
      }
	  
	  
      //detect for mobile devices from https://www.sitepoint.com/navigator-useragent-mobiles-including-ipad/
      function detectMobile()
      {
          var result = (navigator.userAgent.match(/(iphone)|(ipod)|(ipad)|(android)|(blackberry)|(windows phone)|(symbian)/i));

          if(result !== null)
          {
              return "mobile";
          } else {
              return "desktop";
          }
      }

      function getMouseDown()
      {
          if(detectMobile() == "desktop")
          {
              return "mousedown";
          } else {
              return "touchstart";
          }
      }

      function getMouseUp()
      {
          if(detectMobile() == "desktop")
          {
              return "mouseup";
          } else {
              return "touchend";
          }
      }

      function getMouseMove()
      {
          if(detectMobile() == "desktop")
          {
              return "mousemove";
          } else {
              return "touchmove";
          }
      }

      main1();
	  main2();
	  
</script>
  <script src="./js/jsPlumb.js"></script>	
	<script src="./js/demo.js"> </script> 
	 
</body><!--body tag end-->
</html><!--html tag end-->
